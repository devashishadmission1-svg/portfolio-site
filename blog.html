<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blogs | Devashish Pathak</title>
    <meta name="description" content="Thoughts on AI, Psychology, and Technology.">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar fade-in">
        <div class="container">
            <a href="index.html" class="logo">Port.</a>
            <ul class="nav-links">
                <li><a href="index.html#about">About</a></li>
                <li><a href="index.html#projects">Work</a></li>
                <li><a href="index.html#contact">Contact</a></li>
                <li><a href="index.html#resume" class="btn-res">Resume</a></li>
            </ul>
        </div>
    </nav>

    <header class="hero-section" style="min-height: 40vh;">
        <div class="container">
            <h1 class="hero-title fade-in-up">Blogs</h1>
            <p class="hero-subtitle fade-in-up delay-10">Exploring the intersection of Artificial Intelligence and
                Psychology.</p>
        </div>
    </header>

    <section class="section">
        <div class="container">
            <div id="blog-list" class="blog-grid animate-on-scroll">
                <!-- Blog posts will be injected here by JS -->
                <!-- Example of static post if JS fails or empty -->
                <article class="blog-card">
                    <span class="date">Dec 17, 2024</span>
                    <h3>Welcome to my Thought Space</h3>
                    <p>Here I will be documenting my journey through AI research and my fascination with human
                        cognition. Stay tuned for updates.</p>
                </article>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <p><a href="login.html" class="hidden-login">&copy;</a> Designed and created by Devashish Pathak. All rights
                reserved.</p>
        </div>
    </footer>

    <!-- Dragon Background (Optional, kept for consistency) -->
    <div class="dragon-container">
        <svg id="dragon-svg" viewBox="0 0 800 600" preserveAspectRatio="xMidYMid slice">
            <!-- Reusing the dragon defs for consistency, or we can leave it empty if we want a cleaner look. 
                 For now, I'll include the container so the JS doesn't break if it looks for it, 
                 but maybe we make it static or simpler. -->
            <defs>
                <g id="Cabeza" transform="matrix(1, 0, 0, 1, 0, 0)">
                    <path style="fill:#8a0000;fill-opacity:1"
                        d="M-28.9,-1.1L-28.55 -1.95Q-28.1 -3.1 -27.25 -2.95L-26.7 -2.95Q-27.7 -1.65 -28.9 -1.1M-18.35,-1.8Q-15.1 -10.3 -9.6 -6.05Q-15.1 -6.2 -18.35 -1.8M-18.35,1.1Q-15.1 5.45 -9.6 5.35Q-15.1 9.55 -18.35 1.1M-26.7,2.2L-27.25 2.25Q-28.1 2.4 -28.55 1.2L-28.9 0.35Q-27.7 0.9 -26.7 2.2" />
                    <path style="fill:#ff1a1a;fill-opacity:1"
                        d="M-21.05,-8.25Q-13.6 -15.95 -1.3 -12.1Q-7.85 -8.5 -5.85 -4.35Q-2.3 -4.85 10.5 0.15Q0 4.35 -5.85 3.65Q-7.85 7.75 -1.25 12.45Q-13.6 15.2 -21.05 7.5Q-29.55 4.05 -30.2 -0.35Q-29.55 -4.8 -21.05 -8.25M-26.7,-2.95L-27.25 -2.95Q-28.1 -3.1 -28.55 -1.95L-28.9 -1.1Q-27.7 -1.65 -26.7 -2.95M-9.6,-6.05Q-15.1 -10.3 -18.35 -1.8Q-15.1 -6.2 -9.6 -6.05M-9.6,5.35Q-15.1 5.45 -18.35 1.1Q-15.1 9.55 -9.6 5.35M-28.9,0.35L-28.55 1.2Q-28.1 2.4 -27.25 2.25L-26.7 2.2Q-27.7 0.9 -28.9 0.35" />
                </g>
                <!-- Simplified for brevity in new pages, main.js will populate if needed -->
            </defs>
            <g id="dragon-screen"></g>
        </svg>
    </div>

    <script src="js/main.js"></script>
    <script>
        // Inline script to render blogs from localStorage
        document.addEventListener('DOMContentLoaded', () => {
            const blogList = document.getElementById('blog-list');
            const storedPosts = JSON.parse(localStorage.getItem('blogPosts')) || [];

            // Add default post if empty
            if (storedPosts.length === 0) {
                // No action, static post remains
            } else {
                // Clear static post if we have dynamic content? 
                // Let's prepend dynamic posts or just list them.
                // For a "site builder" feel, let's keep the static one as a "Pinned" post or simple placeholder.

                storedPosts.forEach(post => {
                    const div = document.createElement('article');
                    div.className = 'blog-card';
                    div.innerHTML = `
                    <span class="date">${post.date}</span>
                    <h3>${post.title}</h3>
                    <p>${post.content}</p>
                    
                    <!-- Comment Section -->
                    <div class="comments-section" style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid var(--border-color);">
                        <h4 style="font-size: 1rem; margin-bottom: 0.5rem; color: var(--intro-text);">Comments</h4>
                        <div id="comments-${post.id}" class="comments-list" style="margin-bottom: 1rem;">
                            <!-- Comments injected here -->
                        </div>
                        
                        <form onsubmit="submitComment(event, '${post.id}')" style="display: flex; flex-direction: column; gap: 0.5rem;">
                            <input type="text" name="name" class="minimal-input" placeholder="Your Name" required style="font-size: 0.9rem; padding: 0.5rem;">
                            <textarea name="text" class="minimal-input" placeholder="Add a comment..." required rows="2" style="font-size: 0.9rem; padding: 0.5rem; resize: vertical;"></textarea>
                            <button type="submit" class="btn btn-primary" style="padding: 0.5rem 1rem; font-size: 0.8rem; align-self: flex-start;">Post</button>
                        </form>
                    </div>
                `;
                    blogList.prepend(div);

                    // Load comments for this post
                    loadComments(post.id);
                });
            }
        });

        // Comment Logic
        function loadComments(postId) {
            if (!postId) return; // Handle legacy posts without IDs gracefully

            const commentsMap = JSON.parse(localStorage.getItem('blogComments')) || {};
            const postComments = commentsMap[postId] || [];
            const listEl = document.getElementById(`comments-${postId}`);

            if (!listEl) return; // Ensure the element exists before trying to manipulate it

            listEl.innerHTML = ''; // Clear

            if (postComments.length === 0) {
                listEl.innerHTML = '<p style="font-size: 0.8rem; opacity: 0.5; font-style: italic;">No comments yet.</p>';
                return;
            }

            postComments.forEach(c => {
                const cDiv = document.createElement('div');
                cDiv.style.marginBottom = '0.75rem';
                cDiv.style.paddingLeft = '0.5rem';
                cDiv.style.borderLeft = '2px solid var(--border-color)';
                cDiv.innerHTML = `
                    <div style="font-size: 0.8rem; font-weight: bold; color: var(--primary-color);">${c.name} <span style="font-weight: normal; color: var(--intro-text); opacity: 0.5; font-size: 0.7rem;">â€¢ ${c.date}</span></div>
                    <div style="font-size: 0.9rem;">${c.text}</div>
                `;
                listEl.appendChild(cDiv);
            });
        }

        function submitComment(e, postId) {
            e.preventDefault();
            if (!postId || postId === 'undefined') {
                alert('Cannot comment on legacy posts. Only new posts support comments.');
                return;
            }

            const form = e.target;
            const name = form.name.value;
            const text = form.text.value;
            const date = new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric' });

            const newComment = { name, text, date };

            // Save to LocalStorage
            const commentsMap = JSON.parse(localStorage.getItem('blogComments')) || {};
            if (!commentsMap[postId]) commentsMap[postId] = [];

            commentsMap[postId].push(newComment);
            localStorage.setItem('blogComments', JSON.stringify(commentsMap));

            // Reload UI
            loadComments(postId);
            form.reset();
        }
    </script>
</body>
    

</html>
